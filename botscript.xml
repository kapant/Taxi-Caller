<context>
	<pattern name = "From" value = "$Text"/>
	<pattern name = "To" value = "$Text"/>
	<input pattern = "* такси * { [(от|с) [$From]] * [(до|к) [$To]] }">
  		<context if = "empty($From)" modal = "true">
			<output value = "Откуда едем?"/>
			<input pattern = "$From">
				<context id = "empty_to" if = "empty($To)"/>
				<context id = "done"/>
			</input>
		</context>
		<context if = "empty($To)" modal = "true" id = "empty_to">
			<output value = "Куда едем?"/>
			<input pattern = "$To">
				<context id = "done"/>
			</input>
		</context>
		<context id = "done">
			<get url = "https://geocode-maps.yandex.ru/1.x/" var = "Place">
				<param name = "format" value = "json"/>
				<param name = "geocode" value = "$From"/>
			</get>
			<var name = "GeoFrom">
				<script>
					$Place.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.text;
				</script>
			</var>
			<get url = "https://geocode-maps.yandex.ru/1.x/" var = "Place">
				<param name = "format" value = "json"/>
				<param name = "geocode" value = "$To"/>
			</get>
			<var name = "GeoTo">
				<script>
					$Place.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.text;
				</script>
			</var>
			<output value = "Нужно такси от $GeoFrom до $GeoTo, верно?"/>
		</context>
	</input>
	<input pattern = " * (адрес) $Text">
		<get url = "https://geocode-maps.yandex.ru/1.x/" var = "Place">
			<param name = "format" value = "json"/>
			<param name = "geocode" value = "$Text"/>
		</get>
		<var name = "Address">
			<script>
				$Place.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.text;
			</script>
		</var>
		<output value = "$Address"/>
	</input>
	<input pattern = "тест">
		<get url = "https://api.telegram.org/bot409639273:AAHL6W-utcg_GbqbXkP-w5Hq_A9y_4PaKtc/getMe" var = "Res"/>
		<var name = "Name">
			<script>
				$Res.result.first_name;
			</script>
		</var>
		<output value = "$Name"/>
	</input>
</context>
